image: node:14
stages:
  - build
  - staging

cache:
  paths:
    - node_modules

build:
  stage:  build
  before_script:
    - yarn install
  script:
    - yarn build
  artifacts:
    paths:
      - build/



staging:
  image:
    name: minio/mc
    entrypoint: ['']
  stage: staging
  before_script:
    - mc alias set minio $MINIO_HOST $MINIO_ACCESS_KEY $MINIO_SECRET_KEY
  script:
    - mc mb -p minio/sway-me/docs
    - mc cp --recursive build minio/sway-me/docs
  dependencies:
    - build
  only:
    - master